<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title>CatchMind 1:1 - Guesser</title>
    <meta name="my-role" content="GUESSER"/>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          rel="stylesheet"/>
</head>
<body class="bg-light">

<!-- 공통 헤더 -->
<header th:replace="layouts/index :: global-header"></header>

<main class="container-fluid py-3">
    <div class="row g-3">

        <!-- 그림판 Fragment -->
        <section class="col-lg-8"
                 th:replace="layouts/mainGameUI :: drawing-area">
        </section>

        <!-- 우측 패널 -->
        <aside class="col-lg-4">

            <!-- 공통 게임 정보 -->
            <section class="border bg-white p-3 mb-3"
                     th:replace="layouts/mainGameUI :: game-info-card"></section>

            <!-- 정답 입력 -->
            <section class="border bg-white p-3">

                <h2 class="h6">정답 입력</h2>

                <form th:action="@{/game/answer}" method="post"
                      class="d-flex gap-2 mt-2" id="guess-form">

                    <input type="text"
                           name="answer"
                           class="form-control"
                           placeholder="정답을 입력하세요"
                           id="answer-input"/>
                    <input type="hidden" name="userId" th:value="${myName}"/>

                    <button type="submit" class="btn btn-primary">
                        정답 확인
                    </button>
                </form>
            </section>

            <!-- 정답 결과 (Drawer/Guesser 공통 구조) -->
            <section class="border bg-white p-3 mt-3">
                <h2 class="h6 mb-2">정답 결과</h2>
                <div id="guess-result">
                    <p th:if="${lastResult != null}">
            <span th:text="${lastResult} ? '정답입니다!' : '틀렸습니다. 다시 시도해보세요!'">
                정답입니다!
            </span>
                        <!-- 남은 기회도 함께 표시 -->
                        <span th:if="${triesLeft != null}">
                (
                남은 기회:
                <span th:text="${triesLeft}">5</span>번
                )
            </span>
                    </p>
                </div>
            </section>

        </aside>
    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- 포커스 스크립트 -->
<script>
    const input = document.getElementById('answer-input');
    if (input) input.focus();
<!--    페이지 불러오자마자 자동 포커스-->
</script>

<script src="/js/game-socket.js"></script>

</body>
</html>
